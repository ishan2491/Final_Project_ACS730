{"filter":false,"title":"main.tf","tooltip":"/modules/ec2/main.tf","undoManager":{"mark":100,"position":100,"stack":[[{"start":{"row":19,"column":4},"end":{"row":19,"column":47},"action":"remove","lines":["values = [\"${var.vpc_prod}-PublicSubnet-*\"]"],"id":54}],[{"start":{"row":19,"column":4},"end":{"row":19,"column":40},"action":"insert","lines":["values = [\"Prod-VPC-PublicSubnet-*\"]"],"id":55}],[{"start":{"row":35,"column":4},"end":{"row":35,"column":48},"action":"remove","lines":["values = [\"${var.vpc_prod}-PrivateSubnet-*\"]"],"id":58}],[{"start":{"row":35,"column":4},"end":{"row":35,"column":40},"action":"insert","lines":["values = [\"Prod-VPC-PublicSubnet-*\"]"],"id":59}],[{"start":{"row":35,"column":29},"end":{"row":35,"column":30},"action":"remove","lines":["c"],"id":60},{"start":{"row":35,"column":28},"end":{"row":35,"column":29},"action":"remove","lines":["i"]},{"start":{"row":35,"column":27},"end":{"row":35,"column":28},"action":"remove","lines":["l"]},{"start":{"row":35,"column":26},"end":{"row":35,"column":27},"action":"remove","lines":["b"]},{"start":{"row":35,"column":25},"end":{"row":35,"column":26},"action":"remove","lines":["u"]}],[{"start":{"row":35,"column":25},"end":{"row":35,"column":26},"action":"insert","lines":["r"],"id":61},{"start":{"row":35,"column":26},"end":{"row":35,"column":27},"action":"insert","lines":["i"]},{"start":{"row":35,"column":27},"end":{"row":35,"column":28},"action":"insert","lines":["a"]},{"start":{"row":35,"column":28},"end":{"row":35,"column":29},"action":"insert","lines":["v"]},{"start":{"row":35,"column":29},"end":{"row":35,"column":30},"action":"insert","lines":["t"]},{"start":{"row":35,"column":30},"end":{"row":35,"column":31},"action":"insert","lines":["e"]}],[{"start":{"row":35,"column":5},"end":{"row":35,"column":41},"action":"remove","lines":["alues = [\"Prod-VPC-PriavteSubnet-*\"]"],"id":62},{"start":{"row":35,"column":4},"end":{"row":35,"column":5},"action":"remove","lines":["v"]}],[{"start":{"row":35,"column":4},"end":{"row":35,"column":48},"action":"insert","lines":["values = [\"${var.vpc_prod}-PrivateSubnet-*\"]"],"id":63}],[{"start":{"row":164,"column":64},"end":{"row":164,"column":65},"action":"remove","lines":["0"],"id":64}],[{"start":{"row":164,"column":64},"end":{"row":164,"column":65},"action":"insert","lines":["1"],"id":65}],[{"start":{"row":178,"column":64},"end":{"row":178,"column":65},"action":"remove","lines":["1"],"id":66}],[{"start":{"row":178,"column":64},"end":{"row":178,"column":65},"action":"insert","lines":["0"],"id":67}],[{"start":{"row":142,"column":63},"end":{"row":142,"column":64},"action":"remove","lines":["3"],"id":68}],[{"start":{"row":142,"column":63},"end":{"row":142,"column":64},"action":"insert","lines":["0"],"id":69}],[{"start":{"row":120,"column":63},"end":{"row":120,"column":64},"action":"remove","lines":["2"],"id":70}],[{"start":{"row":120,"column":63},"end":{"row":120,"column":64},"action":"insert","lines":["1"],"id":71}],[{"start":{"row":98,"column":63},"end":{"row":98,"column":64},"action":"remove","lines":["1"],"id":72}],[{"start":{"row":98,"column":63},"end":{"row":98,"column":64},"action":"insert","lines":["2"],"id":73}],[{"start":{"row":76,"column":63},"end":{"row":76,"column":64},"action":"remove","lines":["0"],"id":74}],[{"start":{"row":76,"column":63},"end":{"row":76,"column":64},"action":"insert","lines":["3"],"id":75}],[{"start":{"row":38,"column":0},"end":{"row":39,"column":0},"action":"insert","lines":["",""],"id":76}],[{"start":{"row":39,"column":0},"end":{"row":48,"column":0},"action":"insert","lines":["data \"aws_ami\" \"amazon_linux_2\" {","  most_recent = true","  owners      = [\"amazon\"]","","  filter {","    name   = \"name\"","    values = [\"amzn2-ami-hvm-*-x86_64-gp2\"]","  }","}",""],"id":77}],[{"start":{"row":48,"column":0},"end":{"row":49,"column":0},"action":"insert","lines":["",""],"id":78}],[{"start":{"row":48,"column":0},"end":{"row":49,"column":0},"action":"remove","lines":["",""],"id":79}],[{"start":{"row":84,"column":27},"end":{"row":84,"column":37},"action":"remove","lines":["var.ami_id"],"id":80}],[{"start":{"row":84,"column":27},"end":{"row":84,"column":57},"action":"insert","lines":["data.aws_ami.amazon_linux_2.id"],"id":81}],[{"start":{"row":106,"column":27},"end":{"row":106,"column":37},"action":"remove","lines":["var.ami_id"],"id":82}],[{"start":{"row":106,"column":27},"end":{"row":106,"column":57},"action":"insert","lines":["data.aws_ami.amazon_linux_2.id"],"id":83}],[{"start":{"row":128,"column":27},"end":{"row":128,"column":37},"action":"remove","lines":["var.ami_id"],"id":84}],[{"start":{"row":128,"column":27},"end":{"row":128,"column":57},"action":"insert","lines":["data.aws_ami.amazon_linux_2.id"],"id":85}],[{"start":{"row":150,"column":27},"end":{"row":150,"column":37},"action":"remove","lines":["var.ami_id"],"id":86}],[{"start":{"row":150,"column":27},"end":{"row":150,"column":57},"action":"insert","lines":["data.aws_ami.amazon_linux_2.id"],"id":87}],[{"start":{"row":172,"column":28},"end":{"row":172,"column":37},"action":"remove","lines":["ar.ami_id"],"id":88},{"start":{"row":172,"column":27},"end":{"row":172,"column":28},"action":"remove","lines":["v"]}],[{"start":{"row":172,"column":27},"end":{"row":172,"column":57},"action":"insert","lines":["data.aws_ami.amazon_linux_2.id"],"id":89}],[{"start":{"row":186,"column":27},"end":{"row":186,"column":37},"action":"remove","lines":["var.ami_id"],"id":90}],[{"start":{"row":186,"column":27},"end":{"row":186,"column":57},"action":"insert","lines":["data.aws_ami.amazon_linux_2.id"],"id":91}],[{"start":{"row":201,"column":20},"end":{"row":201,"column":30},"action":"remove","lines":["var.ami_id"],"id":92}],[{"start":{"row":201,"column":20},"end":{"row":201,"column":50},"action":"insert","lines":["data.aws_ami.amazon_linux_2.id"],"id":93}],[{"start":{"row":240,"column":0},"end":{"row":241,"column":0},"action":"insert","lines":["",""],"id":94}],[{"start":{"row":241,"column":0},"end":{"row":252,"column":0},"action":"insert","lines":["# Example: Create or import a Bastion key pair","resource \"aws_key_pair\" \"bastion\" {","  key_name   = \"bastion_key\"","  public_key = file(\"${path.module}/bastion_key.pub\")","}","","# Example: Create or import a Web key pair","resource \"aws_key_pair\" \"web\" {","  key_name   = \"web_key\"","  public_key = file(\"${path.module}/web_key.pub\")","}",""],"id":95}],[{"start":{"row":241,"column":0},"end":{"row":241,"column":46},"action":"remove","lines":["# Example: Create or import a Bastion key pair"],"id":96}],[{"start":{"row":247,"column":0},"end":{"row":247,"column":42},"action":"remove","lines":["# Example: Create or import a Web key pair"],"id":97}],[{"start":{"row":88,"column":27},"end":{"row":88,"column":43},"action":"remove","lines":["var.web_key_name"],"id":98},{"start":{"row":88,"column":26},"end":{"row":88,"column":27},"action":"remove","lines":[" "]},{"start":{"row":88,"column":25},"end":{"row":88,"column":26},"action":"remove","lines":["="]},{"start":{"row":88,"column":24},"end":{"row":88,"column":25},"action":"remove","lines":[" "]},{"start":{"row":88,"column":22},"end":{"row":88,"column":24},"action":"remove","lines":["  "]},{"start":{"row":88,"column":20},"end":{"row":88,"column":22},"action":"remove","lines":["  "]}],[{"start":{"row":88,"column":18},"end":{"row":88,"column":20},"action":"remove","lines":["  "],"id":99},{"start":{"row":88,"column":16},"end":{"row":88,"column":18},"action":"remove","lines":["  "]},{"start":{"row":88,"column":14},"end":{"row":88,"column":16},"action":"remove","lines":["  "]},{"start":{"row":88,"column":12},"end":{"row":88,"column":14},"action":"remove","lines":["  "]},{"start":{"row":88,"column":10},"end":{"row":88,"column":12},"action":"remove","lines":["  "]},{"start":{"row":88,"column":9},"end":{"row":88,"column":10},"action":"remove","lines":["e"]},{"start":{"row":88,"column":8},"end":{"row":88,"column":9},"action":"remove","lines":["m"]},{"start":{"row":88,"column":7},"end":{"row":88,"column":8},"action":"remove","lines":["a"]},{"start":{"row":88,"column":6},"end":{"row":88,"column":7},"action":"remove","lines":["n"]},{"start":{"row":88,"column":5},"end":{"row":88,"column":6},"action":"remove","lines":["_"]},{"start":{"row":88,"column":4},"end":{"row":88,"column":5},"action":"remove","lines":["y"]},{"start":{"row":88,"column":3},"end":{"row":88,"column":4},"action":"remove","lines":["e"]},{"start":{"row":88,"column":2},"end":{"row":88,"column":3},"action":"remove","lines":["k"]}],[{"start":{"row":88,"column":2},"end":{"row":88,"column":36},"action":"insert","lines":["key_name               = \"web_key\""],"id":100}],[{"start":{"row":132,"column":3},"end":{"row":132,"column":43},"action":"remove","lines":["ey_name               = var.web_key_name"],"id":101},{"start":{"row":132,"column":2},"end":{"row":132,"column":3},"action":"remove","lines":["k"]}],[{"start":{"row":132,"column":2},"end":{"row":132,"column":36},"action":"insert","lines":["key_name               = \"web_key\""],"id":102}],[{"start":{"row":154,"column":3},"end":{"row":154,"column":43},"action":"remove","lines":["ey_name               = var.web_key_name"],"id":103},{"start":{"row":154,"column":2},"end":{"row":154,"column":3},"action":"remove","lines":["k"]}],[{"start":{"row":154,"column":2},"end":{"row":154,"column":36},"action":"insert","lines":["key_name               = \"web_key\""],"id":104}],[{"start":{"row":204,"column":2},"end":{"row":204,"column":36},"action":"remove","lines":["key_name        = var.web_key_name"],"id":105}],[{"start":{"row":204,"column":2},"end":{"row":204,"column":36},"action":"insert","lines":["key_name               = \"web_key\""],"id":106}],[{"start":{"row":190,"column":3},"end":{"row":190,"column":47},"action":"remove","lines":["ey_name               = var.bastion_key_name"],"id":107},{"start":{"row":190,"column":2},"end":{"row":190,"column":3},"action":"remove","lines":["k"]}],[{"start":{"row":190,"column":2},"end":{"row":190,"column":36},"action":"insert","lines":["key_name               = \"web_key\""],"id":108}],[{"start":{"row":190,"column":30},"end":{"row":190,"column":31},"action":"remove","lines":["b"],"id":109},{"start":{"row":190,"column":29},"end":{"row":190,"column":30},"action":"remove","lines":["e"]},{"start":{"row":190,"column":28},"end":{"row":190,"column":29},"action":"remove","lines":["w"]}],[{"start":{"row":190,"column":28},"end":{"row":190,"column":29},"action":"insert","lines":["b"],"id":110},{"start":{"row":190,"column":29},"end":{"row":190,"column":30},"action":"insert","lines":["a"]},{"start":{"row":190,"column":30},"end":{"row":190,"column":31},"action":"insert","lines":["s"]},{"start":{"row":190,"column":31},"end":{"row":190,"column":32},"action":"insert","lines":["t"]},{"start":{"row":190,"column":32},"end":{"row":190,"column":33},"action":"insert","lines":["i"]},{"start":{"row":190,"column":33},"end":{"row":190,"column":34},"action":"insert","lines":["o"]},{"start":{"row":190,"column":34},"end":{"row":190,"column":35},"action":"insert","lines":["n"]}],[{"start":{"row":176,"column":3},"end":{"row":176,"column":47},"action":"remove","lines":["ey_name               = var.bastion_key_name"],"id":111},{"start":{"row":176,"column":2},"end":{"row":176,"column":3},"action":"remove","lines":["k"]}],[{"start":{"row":176,"column":2},"end":{"row":176,"column":36},"action":"insert","lines":["key_name               = \"web_key\""],"id":112}],[{"start":{"row":176,"column":30},"end":{"row":176,"column":31},"action":"remove","lines":["b"],"id":113},{"start":{"row":176,"column":29},"end":{"row":176,"column":30},"action":"remove","lines":["e"]},{"start":{"row":176,"column":28},"end":{"row":176,"column":29},"action":"remove","lines":["w"]}],[{"start":{"row":176,"column":28},"end":{"row":176,"column":29},"action":"insert","lines":["b"],"id":114},{"start":{"row":176,"column":29},"end":{"row":176,"column":30},"action":"insert","lines":["a"]},{"start":{"row":176,"column":30},"end":{"row":176,"column":31},"action":"insert","lines":["s"]},{"start":{"row":176,"column":31},"end":{"row":176,"column":32},"action":"insert","lines":["t"]},{"start":{"row":176,"column":32},"end":{"row":176,"column":33},"action":"insert","lines":["i"]},{"start":{"row":176,"column":33},"end":{"row":176,"column":34},"action":"insert","lines":["o"]},{"start":{"row":176,"column":34},"end":{"row":176,"column":35},"action":"insert","lines":["n"]}],[{"start":{"row":110,"column":2},"end":{"row":110,"column":47},"action":"remove","lines":["key_name               = var.bastion_key_name"],"id":115}],[{"start":{"row":110,"column":2},"end":{"row":110,"column":36},"action":"insert","lines":["key_name               = \"web_key\""],"id":116}],[{"start":{"row":110,"column":30},"end":{"row":110,"column":31},"action":"remove","lines":["b"],"id":117},{"start":{"row":110,"column":29},"end":{"row":110,"column":30},"action":"remove","lines":["e"]},{"start":{"row":110,"column":28},"end":{"row":110,"column":29},"action":"remove","lines":["w"]}],[{"start":{"row":110,"column":28},"end":{"row":110,"column":29},"action":"insert","lines":["b"],"id":118},{"start":{"row":110,"column":29},"end":{"row":110,"column":30},"action":"insert","lines":["a"]},{"start":{"row":110,"column":30},"end":{"row":110,"column":31},"action":"insert","lines":["s"]},{"start":{"row":110,"column":31},"end":{"row":110,"column":32},"action":"insert","lines":["t"]},{"start":{"row":110,"column":32},"end":{"row":110,"column":33},"action":"insert","lines":["i"]},{"start":{"row":110,"column":33},"end":{"row":110,"column":34},"action":"insert","lines":["o"]},{"start":{"row":110,"column":34},"end":{"row":110,"column":35},"action":"insert","lines":["n"]}],[{"start":{"row":39,"column":0},"end":{"row":252,"column":0},"action":"remove","lines":["data \"aws_ami\" \"amazon_linux_2\" {","  most_recent = true","  owners      = [\"amazon\"]","","  filter {","    name   = \"name\"","    values = [\"amzn2-ami-hvm-*-x86_64-gp2\"]","  }","}","","# Security Group for Web Servers","resource \"aws_security_group\" \"web_sg\" {","  name        = \"${var.vpc_prod}-WebServer-SG\"","  description = \"Allow HTTP and SSH inbound traffic\"","  vpc_id      = var.vpc_id","","  ingress {","    from_port   = 80","    to_port     = 80","    protocol    = \"tcp\"","    cidr_blocks = [\"0.0.0.0/0\"]","  }","","  ingress {","    from_port   = 22","    to_port     = 22","    protocol    = \"tcp\"","    cidr_blocks = [\"0.0.0.0/0\"]","  }","","  egress {","    from_port   = 0","    to_port     = 0","    protocol    = \"-1\"","    cidr_blocks = [\"0.0.0.0/0\"]","  }","","  tags = {","    Name        = \"${var.vpc_prod}-WebServer-SG\"","    Environment = var.prod","  }","}","","# Web Server 1","resource \"aws_instance\" \"web_1\" {","  ami                    = data.aws_ami.amazon_linux_2.id","  instance_type          = var.instance_type","  subnet_id              = data.aws_subnets.public_subnets.ids[3]","  vpc_security_group_ids = [aws_security_group.web_sg.id]","  key_name               = \"web_key\"","","  user_data = <<-EOF","    #!/bin/bash","    yum install -y httpd","    systemctl start httpd.service","    systemctl enable httpd.service","    echo \"<html><h1>Welcome to VM1 Web Page</h1></html>\" > /var/www/html/index.html","  EOF","","  tags = {","    Name        = \"${var.vpc_prod}-WebServer-1\"","    Environment = var.prod","  }","}","","# Bastion Host (VM2)","resource \"aws_instance\" \"bastion\" {","  ami                    = data.aws_ami.amazon_linux_2.id","  instance_type          = var.instance_type","  subnet_id              = data.aws_subnets.public_subnets.ids[2]","  vpc_security_group_ids = [aws_security_group.web_sg.id]","  key_name               = \"bastion_key\"","","  user_data = <<-EOF","    #!/bin/bash","    yum install -y httpd","    systemctl start httpd.service","    systemctl enable httpd.service","    echo \"<html><h1>Welcome to VM2 Bastion Host</h1></html>\" > /var/www/html/index.html","  EOF","","  tags = {","    Name        = \"${var.vpc_prod}-BastionHost\"","    Environment = var.prod","  }","}","","# Web Server 3","resource \"aws_instance\" \"web_3\" {","  ami                    = data.aws_ami.amazon_linux_2.id","  instance_type          = var.instance_type","  subnet_id              = data.aws_subnets.public_subnets.ids[1]","  vpc_security_group_ids = [aws_security_group.web_sg.id]","  key_name               = \"web_key\"","","  user_data = <<-EOF","    #!/bin/bash","    yum install -y httpd","    systemctl start httpd.service","    systemctl enable httpd.service","    echo \"<html><h1>Welcome to VM3 Web Page</h1></html>\" > /var/www/html/index.html","  EOF","","  tags = {","    Name        = \"${var.vpc_prod}-WebServer-3\"","    Environment = var.prod","  }","}","","# Web Server 4","resource \"aws_instance\" \"web_4\" {","  ami                    = data.aws_ami.amazon_linux_2.id","  instance_type          = var.instance_type","  subnet_id              = data.aws_subnets.public_subnets.ids[0]","  vpc_security_group_ids = [aws_security_group.web_sg.id]","  key_name               = \"web_key\"","","  user_data = <<-EOF","    #!/bin/bash","    yum install -y httpd","    systemctl start httpd.service","    systemctl enable httpd.service","    echo \"<html><h1>Welcome to VM4 Web Page</h1></html>\" > /var/www/html/index.html","  EOF","","  tags = {","    Name        = \"${var.vpc_prod}-WebServer-4\"","    Environment = var.prod","  }","}","","# Database Server 5 (Private Subnet)","resource \"aws_instance\" \"db_5\" {","  ami                    = data.aws_ami.amazon_linux_2.id","  instance_type          = var.instance_type","  subnet_id              = data.aws_subnets.private_subnets.ids[1]","  vpc_security_group_ids = [aws_security_group.web_sg.id]","  key_name               = \"bastion_key\"","","  tags = {","    Name        = \"${var.vpc_prod}-DatabaseServer-5\"","    Environment = var.prod","  }","}","","# Database Server 6 (Private Subnet)","resource \"aws_instance\" \"db_6\" {","  ami                    = data.aws_ami.amazon_linux_2.id","  instance_type          = var.instance_type","  subnet_id              = data.aws_subnets.private_subnets.ids[0]","  vpc_security_group_ids = [aws_security_group.web_sg.id]","  key_name               = \"bastion_key\"","","  tags = {","    Name        = \"${var.vpc_prod}-DatabaseServer-6\"","    Environment = var.prod","  }","}","","# Auto Scaling Launch Configuration for Web Servers","resource \"aws_launch_configuration\" \"web_lc\" {","  name            = \"${var.vpc_prod}-WebServer-LC\"","  image_id        = data.aws_ami.amazon_linux_2.id","  instance_type   = var.instance_type","  security_groups = [aws_security_group.web_sg.id]","  key_name               = \"web_key\"","","  user_data = <<-EOF","    #!/bin/bash","    yum install -y httpd","    systemctl start httpd.service","    systemctl enable httpd.service","    echo \"<html><h1>Welcome to Auto Scaling Group Web Page</h1></html>\" > /var/www/html/index.html","  EOF","","  lifecycle {","    create_before_destroy = true","  }","}","","# Auto Scaling Group for Web Servers","resource \"aws_autoscaling_group\" \"web_asg\" {","  name                 = \"${var.vpc_prod}-WebServer-ASG\"","  launch_configuration = aws_launch_configuration.web_lc.id","  vpc_zone_identifier  = data.aws_subnets.public_subnets.ids","  min_size             = var.min_size","  max_size             = var.max_size","  desired_capacity     = var.desired_capacity","","  tag {","    key                 = \"Name\"","    value               = \"${var.vpc_prod}-WebServer-ASG\"","    propagate_at_launch = true","  }","","  tag {","    key                 = \"Environment\"","    value               = var.prod","    propagate_at_launch = true","  }","}","","","resource \"aws_key_pair\" \"bastion\" {","  key_name   = \"bastion_key\"","  public_key = file(\"${path.module}/bastion_key.pub\")","}","","","resource \"aws_key_pair\" \"web\" {","  key_name   = \"web_key\"","  public_key = file(\"${path.module}/web_key.pub\")","}",""],"id":119}],[{"start":{"row":38,"column":0},"end":{"row":39,"column":0},"action":"insert","lines":["",""],"id":120}],[{"start":{"row":39,"column":0},"end":{"row":252,"column":0},"action":"insert","lines":["data \"aws_ami\" \"amazon_linux_2\" {","  most_recent = true","  owners      = [\"amazon\"]","","  filter {","    name   = \"name\"","    values = [\"amzn2-ami-hvm-*-x86_64-gp2\"]","  }","}","","# Security Group for Web Servers","resource \"aws_security_group\" \"web_sg\" {","  name        = \"${var.vpc_prod}-WebServer-SG\"","  description = \"Allow HTTP and SSH inbound traffic\"","  vpc_id      = var.vpc_id","","  ingress {","    from_port   = 80","    to_port     = 80","    protocol    = \"tcp\"","    cidr_blocks = [\"0.0.0.0/0\"]","  }","","  ingress {","    from_port   = 22","    to_port     = 22","    protocol    = \"tcp\"","    cidr_blocks = [\"0.0.0.0/0\"]","  }","","  egress {","    from_port   = 0","    to_port     = 0","    protocol    = \"-1\"","    cidr_blocks = [\"0.0.0.0/0\"]","  }","","  tags = {","    Name        = \"${var.vpc_prod}-WebServer-SG\"","    Environment = var.prod","  }","}","","# Web Server 1","resource \"aws_instance\" \"web_1\" {","  ami                    = data.aws_ami.amazon_linux_2.id","  instance_type          = var.instance_type","  subnet_id              = data.aws_subnets.public_subnets.ids[3]","  vpc_security_group_ids = [aws_security_group.web_sg.id]","  key_name               = \"web_key\"","","  user_data = <<-EOF","    #!/bin/bash","    yum install -y httpd","    systemctl start httpd.service","    systemctl enable httpd.service","    echo \"<html><h1>Welcome to VM1 Web Page</h1></html>\" > /var/www/html/index.html","  EOF","","  tags = {","    Name        = \"${var.vpc_prod}-WebServer-1\"","    Environment = var.prod","  }","}","","# Bastion Host (VM2)","resource \"aws_instance\" \"bastion\" {","  ami                    = data.aws_ami.amazon_linux_2.id","  instance_type          = var.instance_type","  subnet_id              = data.aws_subnets.public_subnets.ids[2]","  vpc_security_group_ids = [aws_security_group.web_sg.id]","  key_name               = \"bastion_key\"","","  user_data = <<-EOF","    #!/bin/bash","    yum install -y httpd","    systemctl start httpd.service","    systemctl enable httpd.service","    echo \"<html><h1>Welcome to VM2 Bastion Host</h1></html>\" > /var/www/html/index.html","  EOF","","  tags = {","    Name        = \"${var.vpc_prod}-BastionHost\"","    Environment = var.prod","  }","}","","# Web Server 3","resource \"aws_instance\" \"web_3\" {","  ami                    = data.aws_ami.amazon_linux_2.id","  instance_type          = var.instance_type","  subnet_id              = data.aws_subnets.public_subnets.ids[1]","  vpc_security_group_ids = [aws_security_group.web_sg.id]","  key_name               = \"web_key\"","","  user_data = <<-EOF","    #!/bin/bash","    yum install -y httpd","    systemctl start httpd.service","    systemctl enable httpd.service","    echo \"<html><h1>Welcome to VM3 Web Page</h1></html>\" > /var/www/html/index.html","  EOF","","  tags = {","    Name        = \"${var.vpc_prod}-WebServer-3\"","    Environment = var.prod","  }","}","","# Web Server 4","resource \"aws_instance\" \"web_4\" {","  ami                    = data.aws_ami.amazon_linux_2.id","  instance_type          = var.instance_type","  subnet_id              = data.aws_subnets.public_subnets.ids[0]","  vpc_security_group_ids = [aws_security_group.web_sg.id]","  key_name               = \"web_key\"","","  user_data = <<-EOF","    #!/bin/bash","    yum install -y httpd","    systemctl start httpd.service","    systemctl enable httpd.service","    echo \"<html><h1>Welcome to VM4 Web Page</h1></html>\" > /var/www/html/index.html","  EOF","","  tags = {","    Name        = \"${var.vpc_prod}-WebServer-4\"","    Environment = var.prod","  }","}","","# Database Server 5 (Private Subnet)","resource \"aws_instance\" \"db_5\" {","  ami                    = data.aws_ami.amazon_linux_2.id","  instance_type          = var.instance_type","  subnet_id              = data.aws_subnets.private_subnets.ids[1]","  vpc_security_group_ids = [aws_security_group.web_sg.id]","  key_name               = \"bastion_key\"","","  tags = {","    Name        = \"${var.vpc_prod}-DatabaseServer-5\"","    Environment = var.prod","  }","}","","# Database Server 6 (Private Subnet)","resource \"aws_instance\" \"db_6\" {","  ami                    = data.aws_ami.amazon_linux_2.id","  instance_type          = var.instance_type","  subnet_id              = data.aws_subnets.private_subnets.ids[0]","  vpc_security_group_ids = [aws_security_group.web_sg.id]","  key_name               = \"bastion_key\"","","  tags = {","    Name        = \"${var.vpc_prod}-DatabaseServer-6\"","    Environment = var.prod","  }","}","","# Auto Scaling Launch Configuration for Web Servers","resource \"aws_launch_configuration\" \"web_lc\" {","  name            = \"${var.vpc_prod}-WebServer-LC\"","  image_id        = data.aws_ami.amazon_linux_2.id","  instance_type   = var.instance_type","  security_groups = [aws_security_group.web_sg.id]","  key_name               = \"web_key\"","","  user_data = <<-EOF","    #!/bin/bash","    yum install -y httpd","    systemctl start httpd.service","    systemctl enable httpd.service","    echo \"<html><h1>Welcome to Auto Scaling Group Web Page</h1></html>\" > /var/www/html/index.html","  EOF","","  lifecycle {","    create_before_destroy = true","  }","}","","# Auto Scaling Group for Web Servers","resource \"aws_autoscaling_group\" \"web_asg\" {","  name                 = \"${var.vpc_prod}-WebServer-ASG\"","  launch_configuration = aws_launch_configuration.web_lc.id","  vpc_zone_identifier  = data.aws_subnets.public_subnets.ids","  min_size             = var.min_size","  max_size             = var.max_size","  desired_capacity     = var.desired_capacity","","  tag {","    key                 = \"Name\"","    value               = \"${var.vpc_prod}-WebServer-ASG\"","    propagate_at_launch = true","  }","","  tag {","    key                 = \"Environment\"","    value               = var.prod","    propagate_at_launch = true","  }","}","","","resource \"aws_key_pair\" \"bastion\" {","  key_name   = \"bastion_key\"","  public_key = file(\"${path.module}/bastion_key.pub\")","}","","","resource \"aws_key_pair\" \"web\" {","  key_name   = \"web_key\"","  public_key = file(\"${path.module}/web_key.pub\")","}",""],"id":121}],[{"start":{"row":82,"column":0},"end":{"row":252,"column":0},"action":"remove","lines":["# Web Server 1","resource \"aws_instance\" \"web_1\" {","  ami                    = data.aws_ami.amazon_linux_2.id","  instance_type          = var.instance_type","  subnet_id              = data.aws_subnets.public_subnets.ids[3]","  vpc_security_group_ids = [aws_security_group.web_sg.id]","  key_name               = \"web_key\"","","  user_data = <<-EOF","    #!/bin/bash","    yum install -y httpd","    systemctl start httpd.service","    systemctl enable httpd.service","    echo \"<html><h1>Welcome to VM1 Web Page</h1></html>\" > /var/www/html/index.html","  EOF","","  tags = {","    Name        = \"${var.vpc_prod}-WebServer-1\"","    Environment = var.prod","  }","}","","# Bastion Host (VM2)","resource \"aws_instance\" \"bastion\" {","  ami                    = data.aws_ami.amazon_linux_2.id","  instance_type          = var.instance_type","  subnet_id              = data.aws_subnets.public_subnets.ids[2]","  vpc_security_group_ids = [aws_security_group.web_sg.id]","  key_name               = \"bastion_key\"","","  user_data = <<-EOF","    #!/bin/bash","    yum install -y httpd","    systemctl start httpd.service","    systemctl enable httpd.service","    echo \"<html><h1>Welcome to VM2 Bastion Host</h1></html>\" > /var/www/html/index.html","  EOF","","  tags = {","    Name        = \"${var.vpc_prod}-BastionHost\"","    Environment = var.prod","  }","}","","# Web Server 3","resource \"aws_instance\" \"web_3\" {","  ami                    = data.aws_ami.amazon_linux_2.id","  instance_type          = var.instance_type","  subnet_id              = data.aws_subnets.public_subnets.ids[1]","  vpc_security_group_ids = [aws_security_group.web_sg.id]","  key_name               = \"web_key\"","","  user_data = <<-EOF","    #!/bin/bash","    yum install -y httpd","    systemctl start httpd.service","    systemctl enable httpd.service","    echo \"<html><h1>Welcome to VM3 Web Page</h1></html>\" > /var/www/html/index.html","  EOF","","  tags = {","    Name        = \"${var.vpc_prod}-WebServer-3\"","    Environment = var.prod","  }","}","","# Web Server 4","resource \"aws_instance\" \"web_4\" {","  ami                    = data.aws_ami.amazon_linux_2.id","  instance_type          = var.instance_type","  subnet_id              = data.aws_subnets.public_subnets.ids[0]","  vpc_security_group_ids = [aws_security_group.web_sg.id]","  key_name               = \"web_key\"","","  user_data = <<-EOF","    #!/bin/bash","    yum install -y httpd","    systemctl start httpd.service","    systemctl enable httpd.service","    echo \"<html><h1>Welcome to VM4 Web Page</h1></html>\" > /var/www/html/index.html","  EOF","","  tags = {","    Name        = \"${var.vpc_prod}-WebServer-4\"","    Environment = var.prod","  }","}","","# Database Server 5 (Private Subnet)","resource \"aws_instance\" \"db_5\" {","  ami                    = data.aws_ami.amazon_linux_2.id","  instance_type          = var.instance_type","  subnet_id              = data.aws_subnets.private_subnets.ids[1]","  vpc_security_group_ids = [aws_security_group.web_sg.id]","  key_name               = \"bastion_key\"","","  tags = {","    Name        = \"${var.vpc_prod}-DatabaseServer-5\"","    Environment = var.prod","  }","}","","# Database Server 6 (Private Subnet)","resource \"aws_instance\" \"db_6\" {","  ami                    = data.aws_ami.amazon_linux_2.id","  instance_type          = var.instance_type","  subnet_id              = data.aws_subnets.private_subnets.ids[0]","  vpc_security_group_ids = [aws_security_group.web_sg.id]","  key_name               = \"bastion_key\"","","  tags = {","    Name        = \"${var.vpc_prod}-DatabaseServer-6\"","    Environment = var.prod","  }","}","","# Auto Scaling Launch Configuration for Web Servers","resource \"aws_launch_configuration\" \"web_lc\" {","  name            = \"${var.vpc_prod}-WebServer-LC\"","  image_id        = data.aws_ami.amazon_linux_2.id","  instance_type   = var.instance_type","  security_groups = [aws_security_group.web_sg.id]","  key_name               = \"web_key\"","","  user_data = <<-EOF","    #!/bin/bash","    yum install -y httpd","    systemctl start httpd.service","    systemctl enable httpd.service","    echo \"<html><h1>Welcome to Auto Scaling Group Web Page</h1></html>\" > /var/www/html/index.html","  EOF","","  lifecycle {","    create_before_destroy = true","  }","}","","# Auto Scaling Group for Web Servers","resource \"aws_autoscaling_group\" \"web_asg\" {","  name                 = \"${var.vpc_prod}-WebServer-ASG\"","  launch_configuration = aws_launch_configuration.web_lc.id","  vpc_zone_identifier  = data.aws_subnets.public_subnets.ids","  min_size             = var.min_size","  max_size             = var.max_size","  desired_capacity     = var.desired_capacity","","  tag {","    key                 = \"Name\"","    value               = \"${var.vpc_prod}-WebServer-ASG\"","    propagate_at_launch = true","  }","","  tag {","    key                 = \"Environment\"","    value               = var.prod","    propagate_at_launch = true","  }","}","","","resource \"aws_key_pair\" \"bastion\" {","  key_name   = \"bastion_key\"","  public_key = file(\"${path.module}/bastion_key.pub\")","}","","","resource \"aws_key_pair\" \"web\" {","  key_name   = \"web_key\"","  public_key = file(\"${path.module}/web_key.pub\")","}",""],"id":122}],[{"start":{"row":82,"column":0},"end":{"row":252,"column":0},"action":"insert","lines":["# Web Server 1","resource \"aws_instance\" \"web_1\" {","  ami                    = data.aws_ami.amazon_linux_2.id","  instance_type          = var.instance_type","  subnet_id              = data.aws_subnets.public_subnets.ids[3]","  vpc_security_group_ids = [aws_security_group.web_sg.id]","  key_name               = \"web_key\"","","  user_data = <<-EOF","    #!/bin/bash","    yum install -y httpd","    systemctl start httpd.service","    systemctl enable httpd.service","    echo \"<html><h1>Welcome to VM1 Web Page</h1></html>\" > /var/www/html/index.html","  EOF","","  tags = {","    Name        = \"${var.vpc_prod}-WebServer-1\"","    Environment = var.prod","  }","}","","# Bastion Host (VM2)","resource \"aws_instance\" \"bastion\" {","  ami                    = data.aws_ami.amazon_linux_2.id","  instance_type          = var.instance_type","  subnet_id              = data.aws_subnets.public_subnets.ids[2]","  vpc_security_group_ids = [aws_security_group.web_sg.id]","  key_name               = \"bastion_key\"","","  user_data = <<-EOF","    #!/bin/bash","    yum install -y httpd","    systemctl start httpd.service","    systemctl enable httpd.service","    echo \"<html><h1>Welcome to VM2 Bastion Host</h1></html>\" > /var/www/html/index.html","  EOF","","  tags = {","    Name        = \"${var.vpc_prod}-BastionHost\"","    Environment = var.prod","  }","}","","# Web Server 3","resource \"aws_instance\" \"web_3\" {","  ami                    = data.aws_ami.amazon_linux_2.id","  instance_type          = var.instance_type","  subnet_id              = data.aws_subnets.public_subnets.ids[1]","  vpc_security_group_ids = [aws_security_group.web_sg.id]","  key_name               = \"web_key\"","","  user_data = <<-EOF","    #!/bin/bash","    yum install -y httpd","    systemctl start httpd.service","    systemctl enable httpd.service","    echo \"<html><h1>Welcome to VM3 Web Page</h1></html>\" > /var/www/html/index.html","  EOF","","  tags = {","    Name        = \"${var.vpc_prod}-WebServer-3\"","    Environment = var.prod","  }","}","","# Web Server 4","resource \"aws_instance\" \"web_4\" {","  ami                    = data.aws_ami.amazon_linux_2.id","  instance_type          = var.instance_type","  subnet_id              = data.aws_subnets.public_subnets.ids[0]","  vpc_security_group_ids = [aws_security_group.web_sg.id]","  key_name               = \"web_key\"","","  user_data = <<-EOF","    #!/bin/bash","    yum install -y httpd","    systemctl start httpd.service","    systemctl enable httpd.service","    echo \"<html><h1>Welcome to VM4 Web Page</h1></html>\" > /var/www/html/index.html","  EOF","","  tags = {","    Name        = \"${var.vpc_prod}-WebServer-4\"","    Environment = var.prod","  }","}","","# Database Server 5 (Private Subnet)","resource \"aws_instance\" \"db_5\" {","  ami                    = data.aws_ami.amazon_linux_2.id","  instance_type          = var.instance_type","  subnet_id              = data.aws_subnets.private_subnets.ids[1]","  vpc_security_group_ids = [aws_security_group.web_sg.id]","  key_name               = \"bastion_key\"","","  tags = {","    Name        = \"${var.vpc_prod}-DatabaseServer-5\"","    Environment = var.prod","  }","}","","# Database Server 6 (Private Subnet)","resource \"aws_instance\" \"db_6\" {","  ami                    = data.aws_ami.amazon_linux_2.id","  instance_type          = var.instance_type","  subnet_id              = data.aws_subnets.private_subnets.ids[0]","  vpc_security_group_ids = [aws_security_group.web_sg.id]","  key_name               = \"bastion_key\"","","  tags = {","    Name        = \"${var.vpc_prod}-DatabaseServer-6\"","    Environment = var.prod","  }","}","","# Auto Scaling Launch Configuration for Web Servers","resource \"aws_launch_configuration\" \"web_lc\" {","  name            = \"${var.vpc_prod}-WebServer-LC\"","  image_id        = data.aws_ami.amazon_linux_2.id","  instance_type   = var.instance_type","  security_groups = [aws_security_group.web_sg.id]","  key_name               = \"web_key\"","","  user_data = <<-EOF","    #!/bin/bash","    yum install -y httpd","    systemctl start httpd.service","    systemctl enable httpd.service","    echo \"<html><h1>Welcome to Auto Scaling Group Web Page</h1></html>\" > /var/www/html/index.html","  EOF","","  lifecycle {","    create_before_destroy = true","  }","}","","# Auto Scaling Group for Web Servers","resource \"aws_autoscaling_group\" \"web_asg\" {","  name                 = \"${var.vpc_prod}-WebServer-ASG\"","  launch_configuration = aws_launch_configuration.web_lc.id","  vpc_zone_identifier  = data.aws_subnets.public_subnets.ids","  min_size             = var.min_size","  max_size             = var.max_size","  desired_capacity     = var.desired_capacity","","  tag {","    key                 = \"Name\"","    value               = \"${var.vpc_prod}-WebServer-ASG\"","    propagate_at_launch = true","  }","","  tag {","    key                 = \"Environment\"","    value               = var.prod","    propagate_at_launch = true","  }","}","","","resource \"aws_key_pair\" \"bastion\" {","  key_name   = \"bastion_key\"","  public_key = file(\"${path.module}/bastion_key.pub\")","}","","","resource \"aws_key_pair\" \"web\" {","  key_name   = \"web_key\"","  public_key = file(\"${path.module}/web_key.pub\")","}",""],"id":123}],[{"start":{"row":198,"column":0},"end":{"row":240,"column":0},"action":"remove","lines":["# Auto Scaling Launch Configuration for Web Servers","resource \"aws_launch_configuration\" \"web_lc\" {","  name            = \"${var.vpc_prod}-WebServer-LC\"","  image_id        = data.aws_ami.amazon_linux_2.id","  instance_type   = var.instance_type","  security_groups = [aws_security_group.web_sg.id]","  key_name               = \"web_key\"","","  user_data = <<-EOF","    #!/bin/bash","    yum install -y httpd","    systemctl start httpd.service","    systemctl enable httpd.service","    echo \"<html><h1>Welcome to Auto Scaling Group Web Page</h1></html>\" > /var/www/html/index.html","  EOF","","  lifecycle {","    create_before_destroy = true","  }","}","","# Auto Scaling Group for Web Servers","resource \"aws_autoscaling_group\" \"web_asg\" {","  name                 = \"${var.vpc_prod}-WebServer-ASG\"","  launch_configuration = aws_launch_configuration.web_lc.id","  vpc_zone_identifier  = data.aws_subnets.public_subnets.ids","  min_size             = var.min_size","  max_size             = var.max_size","  desired_capacity     = var.desired_capacity","","  tag {","    key                 = \"Name\"","    value               = \"${var.vpc_prod}-WebServer-ASG\"","    propagate_at_launch = true","  }","","  tag {","    key                 = \"Environment\"","    value               = var.prod","    propagate_at_launch = true","  }","}",""],"id":124}],[{"start":{"row":197,"column":0},"end":{"row":198,"column":0},"action":"remove","lines":["",""],"id":125}],[{"start":{"row":197,"column":0},"end":{"row":198,"column":0},"action":"insert","lines":["",""],"id":126}],[{"start":{"row":198,"column":0},"end":{"row":240,"column":0},"action":"insert","lines":["# Auto Scaling Launch Configuration for Web Servers","resource \"aws_launch_configuration\" \"web_lc\" {","  name            = \"${var.vpc_prod}-WebServer-LC\"","  image_id        = data.aws_ami.amazon_linux_2.id","  instance_type   = var.instance_type","  security_groups = [aws_security_group.web_sg.id]","  key_name               = \"web_key\"","","  user_data = <<-EOF","    #!/bin/bash","    yum install -y httpd","    systemctl start httpd.service","    systemctl enable httpd.service","    echo \"<html><h1>Welcome to Auto Scaling Group Web Page</h1></html>\" > /var/www/html/index.html","  EOF","","  lifecycle {","    create_before_destroy = true","  }","}","","# Auto Scaling Group for Web Servers","resource \"aws_autoscaling_group\" \"web_asg\" {","  name                 = \"${var.vpc_prod}-WebServer-ASG\"","  launch_configuration = aws_launch_configuration.web_lc.id","  vpc_zone_identifier  = data.aws_subnets.public_subnets.ids","  min_size             = var.min_size","  max_size             = var.max_size","  desired_capacity     = var.desired_capacity","","  tag {","    key                 = \"Name\"","    value               = \"${var.vpc_prod}-WebServer-ASG\"","    propagate_at_launch = true","  }","","  tag {","    key                 = \"Environment\"","    value               = var.prod","    propagate_at_launch = true","  }","}",""],"id":127}],[{"start":{"row":152,"column":63},"end":{"row":152,"column":64},"action":"remove","lines":["0"],"id":128}],[{"start":{"row":152,"column":63},"end":{"row":152,"column":64},"action":"insert","lines":["3"],"id":129}],[{"start":{"row":130,"column":63},"end":{"row":130,"column":64},"action":"remove","lines":["1"],"id":130}],[{"start":{"row":130,"column":63},"end":{"row":130,"column":64},"action":"insert","lines":["2"],"id":131}],[{"start":{"row":108,"column":63},"end":{"row":108,"column":64},"action":"remove","lines":["2"],"id":132}],[{"start":{"row":108,"column":63},"end":{"row":108,"column":64},"action":"insert","lines":["1"],"id":133}],[{"start":{"row":86,"column":63},"end":{"row":86,"column":64},"action":"remove","lines":["3"],"id":134}],[{"start":{"row":86,"column":63},"end":{"row":86,"column":64},"action":"insert","lines":["0"],"id":135}],[{"start":{"row":174,"column":64},"end":{"row":174,"column":65},"action":"remove","lines":["1"],"id":136}],[{"start":{"row":174,"column":64},"end":{"row":174,"column":65},"action":"insert","lines":["0"],"id":137}],[{"start":{"row":188,"column":64},"end":{"row":188,"column":65},"action":"remove","lines":["0"],"id":138}],[{"start":{"row":188,"column":64},"end":{"row":188,"column":65},"action":"insert","lines":["1"],"id":139}],[{"start":{"row":108,"column":63},"end":{"row":108,"column":64},"action":"remove","lines":["1"],"id":140},{"start":{"row":108,"column":63},"end":{"row":108,"column":64},"action":"insert","lines":["3"]}],[{"start":{"row":152,"column":63},"end":{"row":152,"column":64},"action":"remove","lines":["3"],"id":141}],[{"start":{"row":152,"column":63},"end":{"row":152,"column":64},"action":"insert","lines":["1"],"id":142}],[{"start":{"row":130,"column":63},"end":{"row":130,"column":64},"action":"remove","lines":["2"],"id":143}],[{"start":{"row":130,"column":63},"end":{"row":130,"column":64},"action":"insert","lines":["3"],"id":144}],[{"start":{"row":108,"column":63},"end":{"row":108,"column":64},"action":"remove","lines":["3"],"id":145}],[{"start":{"row":108,"column":63},"end":{"row":108,"column":64},"action":"insert","lines":["2"],"id":146}],[{"start":{"row":144,"column":26},"end":{"row":145,"column":0},"action":"insert","lines":["",""],"id":149},{"start":{"row":145,"column":0},"end":{"row":145,"column":4},"action":"insert","lines":["    "]}],[{"start":{"row":145,"column":4},"end":{"row":145,"column":31},"action":"insert","lines":["ConfigureViaAnsible = \"Yes\""],"id":150}],[{"start":{"row":167,"column":26},"end":{"row":168,"column":0},"action":"insert","lines":["",""],"id":151},{"start":{"row":168,"column":0},"end":{"row":168,"column":4},"action":"insert","lines":["    "]}],[{"start":{"row":168,"column":4},"end":{"row":168,"column":31},"action":"insert","lines":["ConfigureViaAnsible = \"Yes\""],"id":152}],[{"start":{"row":86,"column":63},"end":{"row":86,"column":64},"action":"remove","lines":["0"],"id":155}],[{"start":{"row":86,"column":63},"end":{"row":86,"column":64},"action":"insert","lines":["1"],"id":156}],[{"start":{"row":108,"column":63},"end":{"row":108,"column":64},"action":"remove","lines":["2"],"id":157}],[{"start":{"row":108,"column":63},"end":{"row":108,"column":64},"action":"insert","lines":["0"],"id":158}],[{"start":{"row":153,"column":63},"end":{"row":153,"column":64},"action":"remove","lines":["1"],"id":159}],[{"start":{"row":153,"column":63},"end":{"row":153,"column":64},"action":"insert","lines":["2"],"id":160}]]},"ace":{"folds":[],"scrolltop":1196,"scrollleft":0,"selection":{"start":{"row":153,"column":64},"end":{"row":153,"column":64},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":84,"state":"start","mode":"ace/mode/terraform"}},"timestamp":1744255671666,"hash":"78699a775e0fa9010d309c002a58c959625b566d"}